/// SCHEMA ///
/// 
/// Part(partkey, name, mfgr, brand, type, size, container, retailprice, comment).
/// PartSupp(partkey, suppkey, availqty, supplycost, comment).
/// Supplier(suppkey, name, address, nationkey, phone, acctbal, comment).
/// Customer(custkey, name, address, nationkey, phone, acctbal, mktsegment, comment).
/// Nation(nationkey, name, regionkey, comment).
/// LineItem(orderkey, partkey, suppkey, linenumber, quantity, extendedprice, discount, tax, returnflag, linestatus, shipdate, commitdate, receiptdate, shipinstruct, shipmode, comment).
/// Region(regionkey, name, comment).
/// Orders(orderkey, custkey, orderstatus, totalprice, orderdate, orderpriority, clerk, shippriority, comment).

/// Constraints ///
Part(?P1, ?P2, ?P3, ?P4, ?P5, ?P6, ?P7, ?P8, ?P9) :- PartSupp(?P1, ?PS2, ?PS3, ?PS4, ?PS5).
Supplier(?S1, ?S2, ?S3, ?S4, ?S5, ?S6, ?S7) :- PartSupp(?P1, ?S1, ?PS3, ?PS4, ?PS5).
Nation(?N1, ?N2, ?N3, ?N4) :- Customer(?C1, ?C2, ?C3, ?N1, ?C5, ?C6, ?C7, ?C8).
Nation(?N1, ?N2, ?N3, ?N4) :- Supplier(?S1, ?S2, ?S3, ?N1, ?S5, ?S6, ?S7).
PartSupp(?PS1, ?PS2, ?PS3, ?PS4, ?PS5) :- LineItem(?LI1, ?PS1, ?PS2, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, ?LI9, ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16).
Region(?R1, ?R2, ?R3) :- Nation(?N1, ?N2, ?R1, ?N4).
Orders(?O1, ?O2, ?O3, ?O4, ?O5, ?O6, ?O7, ?O8, ?O9) :- LineItem(?O1, ?LI2, ?LI3, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, ?LI9, ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16).
Customer(?C1, ?C2, ?C3, ?C4, ?C5, ?C6, ?C7, ?C8) :- Orders(?O1, ?C1, ?O3, ?O4, ?O5, ?O6, ?O7, ?O8, ?O9).
ReplacePart(?X2, ?X1) :- ReplacePart(?X1, ?X2).
aux_1(?Z, ?P1, ?P2, ?P3, ?P4, ?P5, ?P6, ?P7, ?P8, ?P9) :- Part(?P1, ?P2, ?P3, ?P4, ?P5, ?P6, ?P7, ?P8, ?P9).
ReplacePart(?Z, ?P1) :- aux_1(?Z, ?P1, ?P2, ?P3, ?P4, ?P5, ?P6, ?P7, ?P8, ?P9).
Part(?Z, ?P2, ?P3, ?P4, ?P5, ?P6, ?P7, ?P8, ?P9) :- aux_1(?Z, ?P1, ?P2, ?P3, ?P4, ?P5, ?P6, ?P7, ?P8, ?P9).

/// CQs ///
Q0(?P1, ?P2) :- ReplacePart(?P1, ?P2).

Q2(?S6, ?S2, ?N2, ?P1, ?P3, ?S3, ?S5, ?S7) :- Part(?P1, ?P2, ?P3, ?P4, 'type', 'size', ?P7, ?P9), PartSupp(?P1, ?PS2, ?PS3, ?PS4, ?PS5), Supplier(?PS2, ?S2, ?S3, ?S4, ?S5, ?S6,?S7), Nation(?S4, ?N2, ?N3, ?N4), Region(?N3, 'region', ?R3).

Q3(?L1,?O8) :- Customer(?C1, ?C2, ?C3, ?C4, ?C5, ?C6, 'segment', ?C8), Orders(?L1, ?C1, ?O3, ?O4, 'date', ?O6, ?O7, ?O8, ?O9), LineItem(?LI1, ?PS1, ?PS2, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, ?LI9, ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16).

Q5(?N2, ?O1, ?L6, ?L7) :- Customer(?C1, ?C2, ?C3, ?C4, ?C5, ?C6, ?C7, ?C8), Orders(?O1, ?C1, ?O3, ?O4, 'date', ?O6, ?O7, ?O8, ?O9), LineItem(?O1, ?LI2, ?LI3, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, ?LI9, ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16), Supplier(?L3, ?S2, ?S3, ?S4, ?S5, ?S6, ?S7), Nation(?C4, ?N2, ?N3, ?N4), Region(?N3, 'region', ?R3).

Q10(?C1, ?C2, ?O1, ?L6, ?L7, ?C6, ?N2, ?C3, ?C5, ?C8) :- Customer(?C1, ?C2, ?C3, ?C4, ?C5, ?C6, ?C7, ?C8), Orders(?O1, ?C1, ?O3, ?O4, 'date', ?O6, ?O7, ?O8, ?O9), LineItem(?O1, ?LI2, ?LI3, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, 'r', ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16), Nation(?C4, ?N2, ?N3, ?N4).

Q11(?PS1, ?PS2, ?PS3) :- PartSupp(?PS1, ?PS2, ?PS3, ?PS4, ?PS5), Supplier(?PS2, ?S2, ?S3, ?S4, ?S5, ?S6, ?S7), Nation(?S4, 'nation', ?N3, ?N4).



/// Constants-free BCQs ///

Q2B() :- Part(?P1, ?P2, ?P3, ?P4, ?P5, ?P6, ?P7, ?P8), PartSupp(?P1, ?PS2, ?PS3, ?PS4, ?PS5), Supplier(?PS2, ?S2, ?S3, ?S4, ?S5, ?S6, ?S7), Nation(?S4, ?N2, ?N3, ?N4), Region(?N3, ?R2, ?R3).

Q3B() :- Customer(?C1, ?C2, ?C3, ?C4, ?C5, ?C6, ?C7, ?C8), Orders(?L1, ?C1, ?O3, ?O4, ?O5, ?O6, ?O7, ?O8, ?O9), LineItem(?LI1, ?PS1, ?PS2, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, ?LI9, ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16).

Q5B() :- Customer(?C1, ?C2, ?C3, ?C4, ?C5, ?C6, ?C7, ?C8), Orders(?O1, ?C1, ?O3, ?O4, ?O5, ?O6, ?O7, ?O8, ?O9), LineItem(?O1, ?LI2, ?LI3, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, ?LI9, ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16), Supplier(?L3, ?S2, ?S3, ?S4, ?S5, ?S6, ?S7), Nation(?C4, ?N2, ?N3, ?N4), Region(?N3, ?N2, ?R3).

Q10B() :- Customer(?C1, ?C2, ?C3, ?C4, ?C5, ?C6, ?C7, ?C8), Orders(?O1, ?C1, ?O3, ?O4, ?O5, ?O6, ?O7, ?O8, ?O9), LineItem(?O1, ?LI2, ?LI3, ?LI4, ?LI5, ?LI6, ?LI7, ?LI8, ?LI9, ?LI10, ?LI11, ?LI12, ?LI13, ?LI14, ?LI15, ?LI16), Nation(?C4, ?N2, ?N3, ?N4).

Q11B() :- PartSupp(?PS1, ?PS2, ?PS3, ?PS4, ?PS5), Supplier(?PS2, ?S2, ?S3, ?S4, ?S5, ?S6, ?S7), Nation(?S4, ?N2, ?N3, ?N4).

?- Q0(?P1, ?P2).
?- Q2(?S6, ?S2, ?N2, ?P1, ?P3, ?S3, ?S5, ?S7).
?- Q3(?L1,?O8).
?- Q5(?N2, ?O1, ?L6, ?L7).
?- Q10(?C1, ?C2, ?O1, ?L6, ?L7, ?C6, ?N2, ?C3, ?C5, ?C8).
?- Q11(?PS1, ?PS2, ?PS3).

?- Q2B().
?- Q3B().
?- Q5B().
?- Q10B().
?- Q11B().
