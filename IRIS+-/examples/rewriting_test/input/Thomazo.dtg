p(?X,?Y) :- q(?X).

q() :- p(?A,?B),p(?C,?B),p(?C,?D),r(?A,?C).

?-q().
